#!/usr/bin/env bash

set -e

# Install required packages
apt-get update -y \
	&& apt-get install -y \
	libevent-dev \
	ncurses-dev \
	build-essential \
	bison \
	pkg-config \
	curl

# Build & install tmux package
URL="https://github.com/tmux/tmux/releases/download/3.3a/tmux-3.3a.tar.gz"
ARCHIVE="$(basename $URL)"
DIRECTORY="$(basename $URL ".tar.gz")"

curl -OL $URL \
	&& tar -xzf $ARCHIVE \
	&& rm $ARCHIVE \
	&& cd $DIRECTORY \
	&& ./configure \
	&& make -j $(nproc) \
	&& make install \
	&& which tmux \
	&& cd .. \
	&& rm -R $DIRECTORY

# Remove unnecessary packages
apt-get remove -y \
	build-essential \
	bison \
	pkg-config \
	curl \
	&& apt-get autoremove -y \
	&& rm -Rf "/var/lib/apt/lists/*"
	
